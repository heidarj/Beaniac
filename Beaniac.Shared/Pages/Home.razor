@page "/"
@using Beaniac.Shared.Services
@inject RestService RestService

<PageTitle>Home</PageTitle>

<FluentPullToRefresh Direction="@PullDirection.Down"
                     OnRefreshAsync="OnRefreshAsync"
                     ShowStaticTip="false">
    <PullingTemplate>
        Pull to refresh
    </PullingTemplate>
    <ReleaseTemplate>
        Release to update
    </ReleaseTemplate>
    <CompletedTemplate>
        Update completed
    </CompletedTemplate>

    <ChildContent>
        <FluentGrid Justify="JustifyContent.FlexStart">
            <FluentGridItem xs="12" sm="6" md="3" lg="2">
                <AddCard Href="/settings" />
            </FluentGridItem>
        @foreach (var coffee in Coffees){
            <FluentGridItem xs="12" sm="6" md="3" lg="2">
                <CoffeeCard coffee=coffee ></CoffeeCard>
            </FluentGridItem>
        }
        </FluentGrid>
    </ChildContent>
</FluentPullToRefresh>

@code {
    private List<Coffee> Coffees = new List<Coffee>();

    protected override async Task OnInitializedAsync()
    {
        var CoffeeResult = await RestService.GetAsync<Coffee>();
        Coffees = CoffeeResult?.Items ?? new List<Coffee>();
    }

    async Task<bool> OnRefreshAsync()
    {
        var CoffeeResult = await RestService.GetAsync<Coffee>();
        Coffees = CoffeeResult?.Items ?? new List<Coffee>();
        await Task.Delay(500);
        return true;
    }
}
